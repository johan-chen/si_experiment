{{ extends "si_experiment/Page.html" }}
{{ block title }}
    {{ if player.participant.tasks_order }}
        Revision Ihrer Schätzung
        <script>
            $(document).ready(function() {
                // create slider
                var slider = document.getElementById('slider_estimator_credit');
                createSliderCredit(slider)

                // write slider results into form field for data export
                document.getElementById("next-button").addEventListener("click", function (){
                     document.getElementById("revision2").value = parseInt(slider.noUiSlider.get(true))
                });
            })
        </script>

    {{ else }}
        Revision Ihrer Schätzung
        <script>
            $(document).ready(function() {
                // create slider
                var slider = document.getElementById('slider_estimator');
                createSliderRealEstate(slider)

                // write slider results into form field for data export
                document.getElementById("next-button").addEventListener("click", function () {
                    document.getElementById("revision2").value = parseInt(slider.noUiSlider.get(true))
                });
            })
        </script>

    {{ endif }}
{{ endblock }}

{{ block content }}

<head>
    <script>
        var c_open = {"sex2": 0, "migration_bg2": 0, "pol_views2": 0, "acc2": 0};
        var c_close = {"sex2": 0, "migration_bg2": 0, "pol_views2": 0, "acc2": 0};


        function showDivAndCount(my_button){
            var div = document.getElementById(my_button);

            if (div.style.display == "none") {
                div.style.display = "block";
                c_open[my_button] += 1;
                document.getElementById("click_" + my_button + "_open2").value = c_open[my_button];
            } else {
                div.style.display = "none";
                c_close[my_button] += 1;
                document.getElementById("click_" + my_button + "_close2").value = c_close[my_button];
            }
        }


        $(document).ready(function() {
            // count clicks
            document.getElementById("click_sex_open2").value = c_open["sex2"];
            document.getElementById("click_sex_close2").value = c_close["sex2"];
            document.getElementById("click_migration_bg_open2").value = c_open["migration_bg2"];
            document.getElementById("click_migration_bg_close2").value = c_close["migration_bg2"];
            document.getElementById("click_pol_views_open2").value = c_open["pol_views2"];
            document.getElementById("click_pol_views_close2").value = c_close["pol_views2"];
            document.getElementById("click_acc_open2").value = c_open["acc2"];
            document.getElementById("click_acc_close2").value = c_close["acc2"];
        })
    </script>
</head>

In diesem Schritt erhalten Sie die <b>Möglichkeit</b>, Ihre abgegebene <b>{{ if player.participant.tasks_order }} Preisschätzung {{ else }} Schätzung der Ausfallwahrscheinlichkeit {{ endif }}
    noch einmal anzupassen</b>. Dazu zeigen wir Ihnen erneut die Eigenschaften
{{ if player.participant.tasks_order }} des Kreditbewerbers {{ else }} der Immobilie {{ endif }}
sowie die Vorhersage der KI. {{ if player.participant.treatment != "none" }}Außerdem können Sie sich noch einmal -- falls gewünscht -- {{ if player.participant.treatment == "both" }}die Vorhersagegenauigkeit der KI
und das Profil des KI Entwicklers ansehen:{{ elif player.participant.treatment == "acc" }}die Vorhersagegenauigkeit der KI:{{ elif player.participant.treatment == "dev"}}das Profil des KI Entwicklers ansehen:{{ endif }} Klicken Sie dazu auf den entsprechenden Button.
{{ endif }}

<br><br>

{{ if player.participant.treatment == "both" }}
<table id="button_table">
    <tr>
        <td>
            <div style="text-align:center" >
                <button type="button"  class="btn btn-secondary" onclick="showDivAndCount('sex2')" style="margin:10px">
                    KI Entwickler: Geschlecht
                </button>
            </div>
        </td>
        <td>
            <div style="text-align:center" >
                <button type="button"  class="btn btn-secondary" onclick="showDivAndCount('migration_bg2')" style="margin:10px">
                    KI Entwickler: Migrationshintergrund
                </button>
            </div>
        </td>
        <td>
            <div style="text-align:center" >
                <button type="button"  class="btn btn-secondary" onclick="showDivAndCount('pol_views2')" style="margin:10px">
                    KI Entwickler: Politische Ansichten
                </button>
            </div>
        </td>
        <td>
            <div style="text-align:center" >
                <button type="button" class="btn btn-secondary" onclick="showDivAndCount('acc2')" style="margin:10px">
                    KI: Vorhersagegenauigkeit
                </button>
            </div>
        </td>
    </tr>
    <tr>
        <td>
            <div id="sex2" style="display:none; border: 1px solid grey; padding: 10px">
                 <table>
                        <tr>
                            <td class="treatment_elem">Geschlecht:</td>
                            <td style="padding-left:10px">{{ developer.gender }}</td>
                        </tr>
                 </table>
            </div>
        </td>
        <td>
            <div id="migration_bg2" style="display:none; border: 1px solid grey; padding: 10px">
                 <table>
                        <tr>
                            <td class="treatment_elem">Migrationshintergrund:</td>
                            <td style="padding-left:10px">{{ developer.migrant }}</td>
                        </tr>
                 </table>
            </div>
        </td>
        <td>
            <div id="pol_views2" style="display:none; border: 1px solid grey; padding: 10px">
                 <table>
                        <tr>
                            <td class="treatment_elem">Politische Ansicht:</td>
                            <td style="padding-left:10px">{{ developer.politics }}</td>
                        </tr>
                 </table>
            </div>
        </td>
        <td>
             <div id="acc2" style="display:none; border: 1px solid grey; padding: 10px">
                 <table>
                    <tr>
                        <td class="treatment_elem">
                            Die <b>Genauigkeit</b> des Algorithmus:{{ if player.participant.tasks_order }} 45%{{ else }} 40%{{ endif }}
                        </td>
                    </tr>
                 </table>
             </div>
        </td>
    </tr>
</table>
{{ endif }}
{{ if player.participant.treatment == "dev"}}
<table id="button_table">
    <tr>
        <td>
            <div style="text-align:center" >
                <button type="button"  class="btn btn-secondary" onclick="showDivAndCount('sex2')" style="margin:10px">
                    KI Entwickler: Geschlecht
                </button>
            </div>
        </td>
        <td>
            <div style="text-align:center" >
                <button type="button"  class="btn btn-secondary" onclick="showDivAndCount('migration_bg2')" style="margin:10px">
                    KI Entwickler: Migrationshintergrund
                </button>
            </div>
        </td>
        <td>
            <div style="text-align:center" >
                <button type="button"  class="btn btn-secondary" onclick="showDivAndCount('pol_views2')" style="margin:10px">
                    KI Entwickler: Politische Ansichten
                </button>
            </div>
        </td>
    </tr>
    <tr>
        <td>
            <div id="sex2" style="display:none; border: 1px solid grey; padding: 10px">
                 <table>
                        <tr>
                            <td class="treatment_elem">Geschlecht:</td>
                            <td style="padding-left:10px">{{ developer.gender }}</td>
                        </tr>
                 </table>
            </div>
        </td>
        <td>
            <div id="migration_bg2" style="display:none; border: 1px solid grey; padding: 10px">
                 <table>
                        <tr>
                            <td class="treatment_elem">Migrationshintergrund:</td>
                            <td style="padding-left:10px">{{ developer.migrant }}</td>
                        </tr>
                 </table>
            </div>
        </td>
        <td>
            <div id="pol_views2" style="display:none; border: 1px solid grey; padding: 10px">
                 <table>
                        <tr>
                            <td class="treatment_elem">Politische Ansicht:</td>
                            <td style="padding-left:10px">{{ developer.politics }}</td>
                        </tr>
                 </table>
            </div>
        </td>
    </tr>
</table>
{{ endif }}
{{ if player.participant.treatment == "acc"}}
<table id="button_table">
    <tr>
        <td>
            <div style="text-align:center" >
                <button type="button" class="btn btn-secondary" onclick="showDivAndCount('acc2')" style="margin:10px">
                    KI: Vorhersagegenauigkeit
                </button>
            </div>
        </td>
    </tr>
    <tr>
        <td>
             <div id="acc2" style="display:none; border: 1px solid grey; padding: 10px">
                 <table>
                    <tr>
                        <td class="treatment_elem">
                            Die <b>Genauigkeit</b> des Algorithmus:{{ if player.participant.tasks_order }} 45%{{ else }} 40%{{ endif }}
                        </td>
                    </tr>
                 </table>
             </div>
        </td>
    </tr>
</table>
{{ endif }}

<input type="hidden" name="click_sex_open2" id="click_sex_open2" />
{{ formfield_errors "click_sex_open2" }}
<input type="hidden" name="click_sex_close2" id="click_sex_close2" />
{{ formfield_errors "click_sex_close2" }}
<input type="hidden" name="click_migration_bg_open2" id="click_migration_bg_open2" />
{{ formfield_errors "click_migration_bg_open2" }}
<input type="hidden" name="click_migration_bg_close2" id="click_migration_bg_close2" />
{{ formfield_errors "click_migration_bg_close2" }}
<input type="hidden" name="click_pol_views_open2" id="click_pol_views_open2" />
{{ formfield_errors "click_pol_views_open2" }}
<input type="hidden" name="click_pol_views_close2" id="click_pol_views_close2" />
{{ formfield_errors "click_pol_views_close2" }}
<input type="hidden" name="click_acc_open2" id="click_acc_open2" />
{{ formfield_errors "click_acc_open2" }}
<input type="hidden" name="click_acc_close2" id="click_acc_close2" />
{{ formfield_errors "click_acc_close2" }}

<br><br>

{{ if player.participant.tasks_order}}
    {{ include "si_experiment/creditRevision.html" }}
{{ else }}
    {{ include "si_experiment/immoRevision.html" }}
{{ endif }}

<input type="hidden" name="revision2" id="revision2" />

<br><br><br>

<br>
<p>
    <b>Aufgabe:</b> Bitte geben Sie Ihre persönliche Einstellung zur folgenden Aussage an.
</p>
<table class="likert">
    <col span="1" class="wide">
    <tr>
        <th></th>
        <th>Stimme <br> nicht zu</th>
        <th>Stimme eher <br> nicht zu</th>
        <th>Neutral</th>
        <th>Stimme eher <br> zu</th>
        <th>Stimme <br> zu</th>
    </tr>

    <tr>
        <th></th>
        {{for choice in form.confRevision2.choices}}
            <th>{{choice}}</th>
        {{endfor}}
    </tr>
    <tr>
        <td class="likert_label">{{ form.confRevision2.label }}</td>
        {{ for choice in form.confRevision2 }}
            <td class="likert_choice">{{ choice }}</td>
        {{ endfor }}
    </tr>
</table>

<br><br>


{{ formfield_errors 'revision2' }}

<button id="next-button" class="otree-btn-next btn btn-primary">
    Weiter
</button>

{{ endblock }}


