{{ extends "si_experiment/Page.html" }}
{{ block title }}
    {{ if player.participant.treatment == "both" }}
        {{ if player.participant.info_first == "dev" }}
        Entwickler und KI
        {{ else }}
        KI und Entwickler
        {{ endif }}
    {{ elif player.participant.treatment == "dev" }}
    KI Entwickler
    {{ elif player.participant.treatment == "acc" }}
    KI
    {{ else }}
    KI zur Vorhersage
    {{ endif }}
{{ endblock }}

{{ block content }}
<script>
        $(document).ready(function() {
            var slider = document.getElementById('slider_wtp');
                // WTP slider
            function filterPipsWTP(value) {
                if (value == 80 || value == 20 || value == 50) {
                    return 1;
                } else {
                    return value % 10 == 0 ? 2 : -1;
                }
            }
                function toEncoderMoney(value) {
                    if (value == 50) {
                        return "-0€"
                    } else if (value == 40 || parseInt(value) == 60) {
                        return "-0.10€"
                    } else if (value == 30 || value == 70){
                        return "-0.20€"
                    } else {
                        return "-0.30€"
                    }
                }
            function createSliderWTP(slider) {
                noUiSlider.create(slider, {
                    start: [50],
                    step: 10,
                    // tooltips: true,
                    range: {
                        'min': [20],
                        'max': [80]
                    },
                    pips: {
                        mode: 'steps',
                        filter: filterPipsWTP,
                        format: {
                            from: fromDecoder,
                            to: toEncoderPercentage,
                        }
                    },
                    format: {
                        from: fromDecoder,
                        to: toEncoderMoney,
                    }
                });
            }
            createSliderWTP(slider)

            // show remaining budget and probability to see prediction
            var budget = document.getElementById("budget");
            var wtp_probab = document.getElementById("wtp_probab");

            slider.noUiSlider.on("update", function(){
                wtp_probab.innerHTML = parseInt(slider.noUiSlider.get(true)) + "%";
            })

            slider.noUiSlider.on("update", function(values, handle){
                budget.innerHTML = ((0.30 - values[handle].substring(1,values[handle].length-1)).toFixed(2) + "€").replace(".", ",")
            })


            // write slider results into form field for data export
            document.getElementById("next-button").addEventListener("click", function (){
                document.getElementById("wtp").value = parseInt(slider.noUiSlider.get(true))
            });

        })
</script>

Im <b>nächsten Schritt</b> werden Sie die Möglichkeit erhalten, Ihre <b>Schätzung noch einmal anzupassen</b>.
Dabei kann Ihnen die soeben <b>vorgestellte KI behilflich</b> sein. Beachten Sie, dass die angepasste Schätzung
final ist und damit potenziell Ihre variable Vergütung bestimmt.

<br>
<br>

{{ if player.participant.treatment == "both" }}
    {{ if player.participant.info_first == "dev" }}
        <div class="treatment">
            <table>
                <tr>
                    <td style="width:15%;vertical-align: top;"><img src="{{ static 'global/expert.png' }}" style="width: 20%" /></td>
                    <td style="width:15%;vertical-align: top"><img src="{{ static 'global/KI.png' }}" style="width: 30%" /></td>
                </tr>
                <tr>
                    <td class="treatment_elem">
                        Der <b>Entwickler</b> der KI des Forscherteams besitzt folgende Eigenschaften:<br><br>
                        <table>
                            <tr>
                                <td><ul><li>Geschlecht:</li></ul></td>
                                <td style="padding-left:10px"><b>{{ developer.gender }}</b></td>
                            </tr>
                            <tr>
                                <td><ul><li>Migrationshintergrund:</li></ul></td>
                                <td style="padding-left:10px"><b>{{ developer.migrant }}</b></td>
                            </tr>
                            <tr>
                                <td><ul><li>Politische Ansicht:</li></ul></td>
                                <td style="padding-left:10px"><b>{{ developer.politics }}</b></td>
                            </tr>
                        </table>
                    </td>
                    <td class="treatment_elem">
                        <table>
                            <tr>
                                <td style="padding-left:10px">Die <b>Genauigkeit</b> der KI beträgt <b>{{ if player.participant.tasks_order }} 40%{{ else }} 45%{{ endif }}. </b></td>
                            </tr>
                            <tr>
                                <td style="padding-left:10px"><br><b>Die KI kann Ihre Chance mehr als vervierfachen:</b>.
                                Die Chance, aus Zufall den richtigen Schritt auf dem Schieberegler zu treffen, beträgt weniger als 10%.</td>
                            </tr>
                        </table>
                    </td>
                </tr>
            </table>
        </div>

    {{ else }}
        <div class="treatment">
            <table>
                <tr>
                    <td style="width:15%;vertical-align: top"><img src="{{ static 'global/KI.png' }}" style="width: 30%" /></td>
                    <td style="width:15%;vertical-align: top"><img src="{{ static 'global/expert.png' }}" style="width: 20%" /></td>
                </tr>
                <tr>
                    <td class="treatment_elem">
                        <table>
                            <tr>
                                <td style="padding-left:10px">Die <b>Genauigkeit</b> der KI beträgt <b>{{ if player.participant.tasks_order }} 40%{{ else }} 45%{{ endif }}. </b></td>
                            </tr>
                            <tr>
                                <td style="padding-left:10px"><br><b>Die KI kann Ihre Chance mehr als vervierfachen</b>:
                                Die Chance, aus Zufall den richtigen Wert auf dem Schieberegler zu treffen, beträgt weniger als 10%.</td>
                            </tr>
                        </table>
                    </td>
                    <td class="treatment_elem">
                        Der <b>Entwickler</b> der KI des Forscherteams besitzt folgende Eigenschaften:<br><br>
                        <table>
                            <tr>
                                <td><ul><li>Geschlecht:</li></ul></td>
                                <td style="padding-left:10px"><b>{{ developer.gender }}</b></td>
                            </tr>
                            <tr>
                                <td><ul><li>Migrationshintergrund:</li></ul></td>
                                <td style="padding-left:10px"><b>{{ developer.migrant }}</b></td>
                            </tr>
                            <tr>
                                <td><ul><li>Politische Ansicht:</li></ul></td>
                                <td style="padding-left:10px"><b>{{ developer.politics }}</b></td>
                            </tr>
                        </table>
                    </td>
                </tr>
            </table>
        </div>
    {{ endif }}
    <br>

{{ elif player.participant.treatment == "dev" }}
<div class="treatment">
    <table>
        <tr>
            <td class="treatment_elem">
                Der <b>Entwickler</b> der KI des Forscherteams besitzt folgende Eigenschaften:
                <table>
                    <tr>
                        <td><ul><li>Geschlecht:</li></ul></td>
                        <td style="padding-left:10px"><b>{{ developer.gender }}</b></td>
                    </tr>
                    <tr>
                        <td><ul><li>Migrationshintergrund:</li></ul></td>
                        <td style="padding-left:10px"><b>{{ developer.migrant }}</b></td>
                    </tr>
                    <tr>
                        <td><ul><li>Politische Ansicht:</li></ul></td>
                        <td style="padding-left:10px"><b>{{ developer.politics }}</b></td>
                    </tr>
                </table>
            </td>
            <td style="width:30%;vertical-align: center"><img src="{{ static 'global/expert.png' }}" style="width: 30%" /></td>
        </tr>
    </table>
</div>
<br>

{{ elif player.participant.treatment == "acc" }}
<div class="treatment">
    <table>
        <tr>
            <td class="treatment_elem">
                <table>
                    <tr>
                        <td style="padding-left:10px">Die <b>Genauigkeit</b> der KI beträgt <b>{{ if player.participant.tasks_order }} 40%{{ else }} 45%{{ endif }}. </b></td>
                    </tr>
                    <tr>
                        <td style="padding-left:10px"><br>Die Chance, aus Zufall den richtigen Wert auf dem Schieberegler zu treffen,
                            beträgt weniger als 10%. Sollten Sie also einfach raten, <b>kann die KI Ihre Chance mehr als vervierfachen</b>.</td>
                    </tr>
                </table>
            </td>
            <td>
                <td style="width:30%;vertical-align: center"><img src="{{ static 'global/KI.png' }}" style="width: 30%" /></td>
            </td>
        </tr>
    </table>
</div>
<br>

{{ endif }}
<div>
    Sie erhalten jetzt <b>0,30€</b> als Budget, mit der Möglichkeit dieses <b>Geld einzusetzen</b>,
    um entweder die Wahrscheinlichkeit zu erhöhen, eine <b>KI-Vorhersage für
    {{ if player.participant.tasks_order }}den Preis der Wohnung{{ else }}das Kreditausfallrisiko{{ endif }}</b> zu sehen, oder um diese
    Wahrscheinlichkeit zu verringern (Ausgangswahrscheinlichkeit ist 50%). Pro 10% Erhöhung oder Senkung der Wahrscheinlichkeit werden Ihrem Budget jeweils 0,10€ abgezogen.
    <br><br>
    Wenn Sie zum Beispiel 80% wählen, besteht eine 80%ige Chance, dass Sie die KI-Vorhersage sehen.
    Wenn Sie 20% wählen, besteht eine 20%ige Chance, dass Sie die KI-Vorhersage sehen. In beiden Fällen bezahlen Sie 0,30€.
    <br><br>
    Nutzen Sie den Schieberegler, um zu bestimmen, mit welcher Wahrscheinlichkeit Sie die KI-Vorhersage
    sehen möchten.
    <br><br>Am Ende erhalten Sie eine <b>variable Vergütung</b>, die von der <b>Genauigkeit Ihrer Schätzungen</b> abhängt.
</div>
<br>
<div>
    <b>Ihr übriges Geld: <span id="budget"></span></b>
</div>
<br>
<br>
<div style="padding-left: 50px; padding-right: 50px" >
    <div id="slider_wtp" ></div>
</div>
<br>
<br>
<br>
<div>
    <b>Die Wahrscheinlichkeit, die KI-Vorhersage zu sehen: <span id="wtp_probab"></span></b>
</div>

<input type="hidden" name="wtp" id="wtp" />

<br>
<button id="next-button" class="otree-btn-next btn btn-primary">
    Weiter
</button>
{{ endblock }}


